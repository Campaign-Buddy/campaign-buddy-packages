import{n as D,p as Ct}from"./navigateObject-ZMXbUPar.js";import{r as _,c as st,g as Rt,R as $e}from"./index-tnPESBdE.js";import{j as S}from"./jsx-runtime-PJfywvQB.js";import{i as Oe}from"./index-C4WGByT4.js";import{i as mn}from"./fuse.esm-DpGxg_dX.js";import{H as N}from"./styled-components.browser.esm-CuL3HyEV.js";function Ee(t){const r=_.useRef(t),[n,i]=_.useState(t);return _.useEffect(()=>(Oe(r.current,t)||i(t),()=>{r.current=t}),[t]),n}function Ce(t,r){const n=Re(t,r??"$");return n.length===0?n:t.type==="object"?n[0]:n}function Re(t,r){if(t.type==="object"&&!t.$uiWidget){const n=[];if(!t.properties)throw new wn("object must define properties",t);for(const[i,s]of Object.entries(t.properties))n.push(...Re(s,`${r}.${i}`));return t.title?[[{kind:"section",title:t.title,uiLayout:n}]]:[n]}else if(t.title)return[r];return[]}class wn extends Error{constructor(r,n){super(`Invalid schema: ${r}

${JSON.stringify(n)}`)}}function Te(t,r){if(typeof t!="object")return!!t;const n={};if(r.properties)for(const[i,s]of Object.entries(r.properties))typeof t[i]!="object"&&(n[i]=!!t),n[i]=Te(t[i],s);return n}var z={exports:{}};z.exports;var ye;function xn(){return ye||(ye=1,function(t,r){var n=200,i="__lodash_hash_undefined__",s=9007199254740991,a="[object Arguments]",o="[object Array]",c="[object Boolean]",l="[object Date]",p="[object Error]",d="[object Function]",y="[object GeneratorFunction]",g="[object Map]",b="[object Number]",j="[object Object]",E="[object Promise]",m="[object RegExp]",O="[object Set]",L="[object String]",Z="[object Symbol]",lt="[object WeakMap]",It="[object ArrayBuffer]",q="[object DataView]",Mt="[object Float32Array]",Pt="[object Float64Array]",Nt="[object Int8Array]",Lt="[object Int16Array]",kt="[object Int32Array]",Wt="[object Uint8Array]",Vt="[object Uint8ClampedArray]",Bt="[object Uint16Array]",Gt="[object Uint32Array]",Qe=/[\\^$.*+?()[\]{}|]/g,Ye=/\w*$/,Xe=/^\[object .+?Constructor\]$/,Ze=/^(?:0|[1-9]\d*)$/,v={};v[a]=v[o]=v[It]=v[q]=v[c]=v[l]=v[Mt]=v[Pt]=v[Nt]=v[Lt]=v[kt]=v[g]=v[b]=v[j]=v[m]=v[O]=v[L]=v[Z]=v[Wt]=v[Vt]=v[Bt]=v[Gt]=!0,v[p]=v[d]=v[lt]=!1;var qe=typeof st=="object"&&st&&st.Object===Object&&st,tr=typeof self=="object"&&self&&self.Object===Object&&self,C=qe||tr||Function("return this")(),Ht=r&&!r.nodeType&&r,Ut=Ht&&!0&&t&&!t.nodeType&&t,er=Ut&&Ut.exports===Ht;function rr(e,u){return e.set(u[0],u[1]),e}function nr(e,u){return e.add(u),e}function ir(e,u){for(var f=-1,h=e?e.length:0;++f<h&&u(e[f],f,e)!==!1;);return e}function or(e,u){for(var f=-1,h=u.length,x=e.length;++f<h;)e[x+f]=u[f];return e}function Kt(e,u,f,h){for(var x=-1,A=e?e.length:0;++x<A;)f=u(f,e[x],x,e);return f}function sr(e,u){for(var f=-1,h=Array(e);++f<e;)h[f]=u(f);return h}function ur(e,u){return e==null?void 0:e[u]}function zt(e){var u=!1;if(e!=null&&typeof e.toString!="function")try{u=!!(e+"")}catch{}return u}function Jt(e){var u=-1,f=Array(e.size);return e.forEach(function(h,x){f[++u]=[x,h]}),f}function dt(e,u){return function(f){return e(u(f))}}function Qt(e){var u=-1,f=Array(e.size);return e.forEach(function(h){f[++u]=h}),f}var cr=Array.prototype,ar=Function.prototype,tt=Object.prototype,pt=C["__core-js_shared__"],Yt=function(){var e=/[^.]+$/.exec(pt&&pt.keys&&pt.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Xt=ar.toString,F=tt.hasOwnProperty,et=tt.toString,fr=RegExp("^"+Xt.call(F).replace(Qe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zt=er?C.Buffer:void 0,qt=C.Symbol,te=C.Uint8Array,lr=dt(Object.getPrototypeOf,Object),dr=Object.create,pr=tt.propertyIsEnumerable,hr=cr.splice,ee=Object.getOwnPropertySymbols,yr=Zt?Zt.isBuffer:void 0,gr=dt(Object.keys,Object),ht=V(C,"DataView"),U=V(C,"Map"),yt=V(C,"Promise"),gt=V(C,"Set"),bt=V(C,"WeakMap"),K=V(Object,"create"),br=P(ht),vr=P(U),_r=P(yt),mr=P(gt),wr=P(bt),re=qt?qt.prototype:void 0,ne=re?re.valueOf:void 0;function I(e){var u=-1,f=e?e.length:0;for(this.clear();++u<f;){var h=e[u];this.set(h[0],h[1])}}function xr(){this.__data__=K?K(null):{}}function jr(e){return this.has(e)&&delete this.__data__[e]}function Sr(e){var u=this.__data__;if(K){var f=u[e];return f===i?void 0:f}return F.call(u,e)?u[e]:void 0}function Ar(e){var u=this.__data__;return K?u[e]!==void 0:F.call(u,e)}function $r(e,u){var f=this.__data__;return f[e]=K&&u===void 0?i:u,this}I.prototype.clear=xr,I.prototype.delete=jr,I.prototype.get=Sr,I.prototype.has=Ar,I.prototype.set=$r;function R(e){var u=-1,f=e?e.length:0;for(this.clear();++u<f;){var h=e[u];this.set(h[0],h[1])}}function Or(){this.__data__=[]}function Er(e){var u=this.__data__,f=rt(u,e);if(f<0)return!1;var h=u.length-1;return f==h?u.pop():hr.call(u,f,1),!0}function Cr(e){var u=this.__data__,f=rt(u,e);return f<0?void 0:u[f][1]}function Rr(e){return rt(this.__data__,e)>-1}function Tr(e,u){var f=this.__data__,h=rt(f,e);return h<0?f.push([e,u]):f[h][1]=u,this}R.prototype.clear=Or,R.prototype.delete=Er,R.prototype.get=Cr,R.prototype.has=Rr,R.prototype.set=Tr;function k(e){var u=-1,f=e?e.length:0;for(this.clear();++u<f;){var h=e[u];this.set(h[0],h[1])}}function Fr(){this.__data__={hash:new I,map:new(U||R),string:new I}}function Dr(e){return nt(this,e).delete(e)}function Ir(e){return nt(this,e).get(e)}function Mr(e){return nt(this,e).has(e)}function Pr(e,u){return nt(this,e).set(e,u),this}k.prototype.clear=Fr,k.prototype.delete=Dr,k.prototype.get=Ir,k.prototype.has=Mr,k.prototype.set=Pr;function W(e){this.__data__=new R(e)}function Nr(){this.__data__=new R}function Lr(e){return this.__data__.delete(e)}function kr(e){return this.__data__.get(e)}function Wr(e){return this.__data__.has(e)}function Vr(e,u){var f=this.__data__;if(f instanceof R){var h=f.__data__;if(!U||h.length<n-1)return h.push([e,u]),this;f=this.__data__=new k(h)}return f.set(e,u),this}W.prototype.clear=Nr,W.prototype.delete=Lr,W.prototype.get=kr,W.prototype.has=Wr,W.prototype.set=Vr;function Br(e,u){var f=mt(e)||pn(e)?sr(e.length,String):[],h=f.length,x=!!h;for(var A in e)F.call(e,A)&&!(x&&(A=="length"||an(A,h)))&&f.push(A);return f}function ie(e,u,f){var h=e[u];(!(F.call(e,u)&&ce(h,f))||f===void 0&&!(u in e))&&(e[u]=f)}function rt(e,u){for(var f=e.length;f--;)if(ce(e[f][0],u))return f;return-1}function Gr(e,u){return e&&oe(u,wt(u),e)}function vt(e,u,f,h,x,A,T){var $;if(h&&($=A?h(e,x,A,T):h(e)),$!==void 0)return $;if(!it(e))return e;var le=mt(e);if(le){if($=sn(e),!u)return rn(e,$)}else{var B=M(e),de=B==d||B==y;if(yn(e))return Qr(e,u);if(B==j||B==a||de&&!A){if(zt(e))return A?e:{};if($=un(de?{}:e),!u)return nn(e,Gr($,e))}else{if(!v[B])return A?e:{};$=cn(e,B,vt,u)}}T||(T=new W);var pe=T.get(e);if(pe)return pe;if(T.set(e,$),!le)var he=f?on(e):wt(e);return ir(he||e,function(xt,ot){he&&(ot=xt,xt=e[ot]),ie($,ot,vt(xt,u,f,h,ot,e,T))}),$}function Hr(e){return it(e)?dr(e):{}}function Ur(e,u,f){var h=u(e);return mt(e)?h:or(h,f(e))}function Kr(e){return et.call(e)}function zr(e){if(!it(e)||ln(e))return!1;var u=fe(e)||zt(e)?fr:Xe;return u.test(P(e))}function Jr(e){if(!ue(e))return gr(e);var u=[];for(var f in Object(e))F.call(e,f)&&f!="constructor"&&u.push(f);return u}function Qr(e,u){if(u)return e.slice();var f=new e.constructor(e.length);return e.copy(f),f}function _t(e){var u=new e.constructor(e.byteLength);return new te(u).set(new te(e)),u}function Yr(e,u){var f=u?_t(e.buffer):e.buffer;return new e.constructor(f,e.byteOffset,e.byteLength)}function Xr(e,u,f){var h=u?f(Jt(e),!0):Jt(e);return Kt(h,rr,new e.constructor)}function Zr(e){var u=new e.constructor(e.source,Ye.exec(e));return u.lastIndex=e.lastIndex,u}function qr(e,u,f){var h=u?f(Qt(e),!0):Qt(e);return Kt(h,nr,new e.constructor)}function tn(e){return ne?Object(ne.call(e)):{}}function en(e,u){var f=u?_t(e.buffer):e.buffer;return new e.constructor(f,e.byteOffset,e.length)}function rn(e,u){var f=-1,h=e.length;for(u||(u=Array(h));++f<h;)u[f]=e[f];return u}function oe(e,u,f,h){f||(f={});for(var x=-1,A=u.length;++x<A;){var T=u[x],$=void 0;ie(f,T,$===void 0?e[T]:$)}return f}function nn(e,u){return oe(e,se(e),u)}function on(e){return Ur(e,wt,se)}function nt(e,u){var f=e.__data__;return fn(u)?f[typeof u=="string"?"string":"hash"]:f.map}function V(e,u){var f=ur(e,u);return zr(f)?f:void 0}var se=ee?dt(ee,Object):vn,M=Kr;(ht&&M(new ht(new ArrayBuffer(1)))!=q||U&&M(new U)!=g||yt&&M(yt.resolve())!=E||gt&&M(new gt)!=O||bt&&M(new bt)!=lt)&&(M=function(e){var u=et.call(e),f=u==j?e.constructor:void 0,h=f?P(f):void 0;if(h)switch(h){case br:return q;case vr:return g;case _r:return E;case mr:return O;case wr:return lt}return u});function sn(e){var u=e.length,f=e.constructor(u);return u&&typeof e[0]=="string"&&F.call(e,"index")&&(f.index=e.index,f.input=e.input),f}function un(e){return typeof e.constructor=="function"&&!ue(e)?Hr(lr(e)):{}}function cn(e,u,f,h){var x=e.constructor;switch(u){case It:return _t(e);case c:case l:return new x(+e);case q:return Yr(e,h);case Mt:case Pt:case Nt:case Lt:case kt:case Wt:case Vt:case Bt:case Gt:return en(e,h);case g:return Xr(e,h,f);case b:case L:return new x(e);case m:return Zr(e);case O:return qr(e,h,f);case Z:return tn(e)}}function an(e,u){return u=u??s,!!u&&(typeof e=="number"||Ze.test(e))&&e>-1&&e%1==0&&e<u}function fn(e){var u=typeof e;return u=="string"||u=="number"||u=="symbol"||u=="boolean"?e!=="__proto__":e===null}function ln(e){return!!Yt&&Yt in e}function ue(e){var u=e&&e.constructor,f=typeof u=="function"&&u.prototype||tt;return e===f}function P(e){if(e!=null){try{return Xt.call(e)}catch{}try{return e+""}catch{}}return""}function dn(e){return vt(e,!0,!0)}function ce(e,u){return e===u||e!==e&&u!==u}function pn(e){return hn(e)&&F.call(e,"callee")&&(!pr.call(e,"callee")||et.call(e)==a)}var mt=Array.isArray;function ae(e){return e!=null&&gn(e.length)&&!fe(e)}function hn(e){return bn(e)&&ae(e)}var yn=yr||_n;function fe(e){var u=it(e)?et.call(e):"";return u==d||u==y}function gn(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=s}function it(e){var u=typeof e;return!!e&&(u=="object"||u=="function")}function bn(e){return!!e&&typeof e=="object"}function wt(e){return ae(e)?Br(e):Jr(e)}function vn(){return[]}function _n(){return!1}t.exports=dn}(z,z.exports)),z.exports}var jn=xn();const X=Rt(jn);function Sn(t){t=`with (sandbox) {${t}}`;const r=new Function("sandbox",t);return function(n){const i=new Proxy(n,{has:An,get:$n});return r(i)}}function An(){return!0}function $n(t,r){if(r!==Symbol.unscopables)return t[r]}function Fe(t,r,n){if(t.includes("return"))throw new Error("Filter expression must not contain return statement");if(/[^\w\d]_\$[^\w\d]|^_\$[^\w\d]|[^\w\d]_\$$|^_\$$/.test(t))throw new Error("Filter expression must not contain '_$'. It is reserved for the internal filter expression implementation.");const i=`return ${t.replace(/@/g,"_$")}`;try{return!!Sn(i)({_$:r,$:n})}catch{return!1}}var w;(function(t){t.RecursiveDescent="recursiveDescent",t.ChildDescent="childDescent",t.Root="root",t.ValueFilter="valueFilter",t.KeyFilter="keyFilter",t.PropertyAccessor="propertyAccessor",t.WildCard="wildCard",t.Slice="slice"})(w||(w={}));function ge(t){if(!t)return;if(t.startsWith(".."))return[{kind:w.RecursiveDescent,content:".."},t.substring(2)];if(t.startsWith("."))return[{kind:w.ChildDescent,content:"."},t.substring(1)];if(t.startsWith("$"))return[{kind:w.Root,content:"$"},t.substring(1)];if(t.startsWith("*"))return[{kind:w.WildCard,content:"*"},t.substring(1)];if(t.startsWith("[?(")){const n=/^\[\?\(((?:\\.|[^\\)])+)\)\]/.exec(t);if(!n)throw new Error("Invalid value filter expression");return[{kind:w.ValueFilter,content:J(n[1])},t.substring(n[0].length)]}if(t.startsWith("[")){const n=/^\[\s*(\d+)?\s*:\s*(\d+)?\s*(?::\s*(\d+))?\s*\]/.exec(t);if(n){const[s,a,o,c]=n;return[{kind:w.Slice,content:`${a??"0"}:${o??""}:${c??"1"}`},t.substring(s.length)]}const i=/^\[((?:'|")?)((?:\\.|[^\\[\]'"])+)\1\]/.exec(t);if(!i)throw new Error("Invalid property accessor expression");return[{kind:w.PropertyAccessor,content:J(i[2])},t.substring(i[0].length)]}if(t.startsWith("<?(")){const n=/^<\?\(((?:\\.|[^\\)])+)\)>/.exec(t);if(!n)throw new Error("Invalid key filter expression");return[{kind:w.KeyFilter,content:J(n[1])},t.substring(n[0].length)]}const r=/^(?:\\.|[^{}.:@<>?()@$[\]\\])+/.exec(t);if(!r)throw new Error(`Invalid property accessor at ${t}`);if(/\s/.test(r[0]))throw new Error("Direct property accessor must not contain whitespace");return[{kind:w.PropertyAccessor,content:J(r[0])},t.substring(r[0].length)]}function be(t){return t==null?void 0:t.replace(/["'{}.:@<>?()@$[\]\\]/g,r=>`\\${r}`)}function J(t){return t==null?void 0:t.replace(/\\(.)/g,(r,n)=>n)}function On(t,r,n){if(!r)return;const i=De(t,r,n);if(!i)return;const s=Ie(t,i,{});if(!(!s||Array.isArray(s)&&s.length===0))return s}function De(t,r,n){let i=r,s="";const a="SubQuery must resolve to a single primitive",{serializeObjectsInSubQuery:o}=n??{};for(;s!==i;){s=i;try{i=i.replace(/\{((?:\\.|[^\\{}])+)\}/g,(c,l)=>{const p=Ie(t,l,n??{});if(typeof p=="object"||p===void 0){if(!o)throw new Error(a);return be(o(p))}if(typeof p=="string"){const d=JSON.stringify(p);return`"${be(d.substring(1,d.length-1))}"`}return JSON.stringify(p)})}catch(c){if(c.message===a)return;throw c}}return i}function Ie(t,r,n){if(!r)return;let i=[{path:"$",data:t}],s=ge(r),a=0;for(;s;){const[o,c]=s;if(n.customDataAccessor&&(i=i.map(l=>{var p;return{path:l.path,data:(p=n.customDataAccessor)===null||p===void 0?void 0:p.call(n,l.path,l.data)}})),i=i.filter(ve),n.onEvaluatingExpression&&n.onEvaluatingExpression(i.map(l=>l.path),o.kind),o.kind===w.Root){if(a!==0)throw new Error("Root accessor must only be at the beginning of a query")}else o.kind===w.RecursiveDescent?i=Me(i):o.kind===w.ValueFilter?i=Cn(i,o.content,t,n):o.kind===w.KeyFilter?i=Rn(i,o.content,t):o.kind===w.PropertyAccessor?i=Tn(i,o.content):o.kind===w.WildCard?i=En(i):o.kind===w.Slice&&(i=Fn(i,o.content));if(i.length===0)return;a++,s=ge(c)}if(n.customDataAccessor&&(i=i.map(o=>{var c;return{path:o.path,data:(c=n.customDataAccessor)===null||c===void 0?void 0:c.call(n,o.path,o.data)}})),i=i.filter(ve),i.length!==0)return i.length===1?i[0].data:i.map(({data:o})=>o)}function En(t){const r=[];for(const n of t){const i=Object.entries(n.data);r.push(...i.map(([s,a])=>({path:`${n.path}.${s}`,data:a})))}return r}function Me(t,r=!0){const n=[];for(const i of t){const s=Object.entries(i.data);typeof i.data=="object"&&r&&n.push(i);for(const[a,o]of s)typeof o=="object"&&(n.push({path:`${i.path}.${a}`,data:o}),n.push(...Me([{path:`${i.path}.${a}`,data:o}],!1)))}return n}function Cn(t,r,n,i){var s;const a=[];for(const o of t){const c=Object.entries(o.data);for(const[l,p]of c){const d=i!=null&&i.customDataAccessor?(s=i.customDataAccessor)===null||s===void 0?void 0:s.call(i,`${o.path}.${l}`,p):p;Fe(r,d,n)&&a.push({path:`${o.path}.${l}`,data:d})}}return a}function Rn(t,r,n){const i=[];for(const s of t){const a=Object.entries(s.data);for(const[o,c]of a)Fe(r,o,n)&&i.push({path:`${s.path}.${o}`,data:c})}return i}function Tn(t,r){const n=[];for(const i of t)typeof i.data=="object"&&n.push({path:`${i.path}.${r}`,data:i.data[r]});return n}function Fn(t,r){const n=[],[i,s,a]=r.split(":"),o=parseInt(i),c=s?parseInt(s):1/0,l=parseInt(a);if(l<=0)throw new Error("Step must be a positive non-zero integer");if(o>c)return[];for(const p of t)if(typeof p.data=="object"&&Array.isArray(p.data)){const d=Math.min(p.data.length,c);for(let y=o;y<d;y+=l)n.push({path:`${p.path}.${y}`,data:p.data[y]})}return n}function ve(t){return t.data!==void 0&&t.data!==null}function Dn(t,r){const n=X(t);return Pe(n,r),n}function Pe(t,r){if(!(t.type!=="object"||!t.properties))for(const n of Object.keys(t.properties))if(t.properties[n].$dynamicTypeExpression){const i=On(r,t.properties[n].$dynamicTypeExpression);if(!i){delete t.properties[n];continue}let s={};if(typeof i=="object"&&Array.isArray(i))for(const a of i)typeof a=="object"&&(s=Object.assign(Object.assign({},s),a));else typeof i=="object"&&(s=i);t.properties[n]={type:"object",properties:s,title:t.properties[n].title,description:t.properties[n].description}}else t.properties[n].type==="object"&&Pe(t.properties[n],r)}function Ne(t){return t.$dynamicTypeExpression?!0:t.type==="object"&&t.properties?Object.values(t.properties).some(Ne):!1}function at({schema:t,location:r}){return D({root:t,location:r,accessNext:(n,i)=>{var s;return(s=n==null?void 0:n.properties)===null||s===void 0?void 0:s[i]}})}function Ri({root:t,value:r,location:n,schema:i}){const s=Ct(n);if(s.length===0)throw new Error("Cannot set value at $");const a=D({root:t,location:s.slice(0,-1),accessNext:(c,l,p)=>{const d=typeof c[l];if(d==="undefined"){const y=i&&at({location:p,schema:i});(y==null?void 0:y.type)==="array"?c[l]=[]:c[l]={}}else if(d!=="object"){console.error(`navigation error, tried to traverse ${d} using path ${s.join(".")}`,r);return}return c[l]}});if(!a)return;const o=s[s.length-1];a[o]=r}function Q(t,r,n,i){return t.map(s=>{var a;if(typeof s=="string"){const o=at({location:s,schema:r});if(!o||o.type==="object"&&(!o.properties||Object.keys(o.properties).length===0))return"";if(o.type==="object"&&!o.$uiWidget&&o.properties){const p=Object.keys(o.properties).map(y=>`${s}.${y}`),d=Q(p,r,n,i);return d.length===0?"":d}const c=D({location:s,root:n}),l=(a=c==null?void 0:c.visibleRoles)!==null&&a!==void 0?a:o==null?void 0:o.$defaultVisibleRoles;return i&&Array.isArray(l)&&l.length&&!l.includes(i)?"":s}if(Array.isArray(s)){const o=Q(s,r,n,i);return o.length===0?"":o}else if(s.kind==="section"){const o=Q(s.uiLayout,r,n,i);return o.length===0?"":Object.assign(Object.assign({},s),{uiLayout:o})}else return s.kind==="columnLayout"&&s.columns.map(c=>Object.assign(Object.assign({},c),{uiLayout:Q(c.uiLayout,r,n,i)})).filter(c=>c.uiLayout.length!==0).length===0?"":s}).filter(s=>s!=="")}function Y(t){return typeof t=="object"&&!Array.isArray(t)}function _e(t,r,n){const a=t.map(o=>{if(typeof o=="string"){const c=at({location:o,schema:r});return!c||c.type==="object"&&!c.properties?{element:o,cols:0}:{element:o,cols:(c==null?void 0:c.$uiCols)||"auto"}}else if(Y(o)&&o.kind==="whiteSpace")return{element:o,cols:o.cols||"auto"};return{element:o,cols:12}}).reduce((o,c)=>c.cols===12?(o.push([]),o):(o[o.length-1].push(c),o),[[]]).find(o=>o.some(c=>c.element===n));return a?Le(a.map(o=>o.cols)):12}function Le(t){const r=t.filter(s=>s==="auto");if(r.length===0)return 12;const n=t.reduce((s,a)=>a==="auto"?s:s+a,0),i=Math.max(0,12-n);return i===0?12:Math.floor(Math.max(1,i/r.length))}var me=function(t,r,n,i){function s(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function c(d){try{p(i.next(d))}catch(y){o(y)}}function l(d){try{p(i.throw(d))}catch(y){o(y)}}function p(d){d.done?a(d.value):s(d.value).then(c,l)}p((i=i.apply(t,r||[])).next())})};function In(t,r,n){const[i,s]=_.useState(!1),[a,o]=_.useState([]),c=_.useMemo(()=>Et(r,n,"$"),[r,n]),l=_.useRef([]),p=_.useRef(),d=_.useRef(!0);_.useEffect(()=>()=>{d.current=!1},[]);const y=mn(b=>me(this,void 0,void 0,function*(){return t?(yield t.getHydratedEntities(b)).entities:[]}));return _.useEffect(()=>{var b;if(Oe(l.current,c)||!t)return;l.current=c,(b=p.current)===null||b===void 0||b.forEach(m=>m.cancel());const j=c.reduce((m,O)=>(m[O.definitionName]||(m[O.definitionName]=[]),m[O.definitionName].push(O),m),{});function E(){return me(this,void 0,void 0,function*(){s(!0),p.current=Object.entries(j).map(([m,O])=>y({ids:O.map(L=>L.id),entityDefinitionName:m}));try{const m=yield Promise.all(p.current);if(!d.current)return;s(!1);const O=m.reduce((L,Z)=>[...L,...Z],[]);o(O)}catch(m){if(!(m!=null&&m.isCanceled))throw m}})}E()},[c,t,r,y]),{hydratedData:_.useMemo(()=>c.length===0?r:Mn(r,a,c),[r,a,c]),isLoading:i}}function Mn(t,r,n){if(n.length===0)return n;const i=X(t);for(const s of n){const a=r.find(o=>o.id===s.id&&o.definitionName===s.definitionName);a&&Pn(i,a,s.path)}return i}function Pn(t,r,n){const i=n.split(".");let s=t;for(let o=0;o<i.length-1;o++){const c=i[o];if(!(c==="$"&&o===0)){if(o++,!s)return;s=s[c]}}const a=i[i.length-1];s&&(s[a]={id:r.id,entityData:r.entityData})}function Et(t,r,n){var i,s;if(!((s=(i=r.$tags)===null||i===void 0?void 0:i.includes)===null||s===void 0)&&s.call(i,"dehydratedEntity")&&r.$entity)return!t||typeof(t==null?void 0:t.id)!="string"?[]:[{id:t.id,definitionName:r.$entity,path:n}];const a=[];if(r.type==="object"&&r.properties&&typeof t=="object")for(const o of Object.keys(r.properties)){const c=r.properties[o],l=t[o];l&&a.push(...Et(l,c,`${n}.${o}`))}if(r.type==="array"&&r.items&&Array.isArray(t))for(let o=0;o<t.length;o++){const c=t[o];c&&a.push(...Et(c,r.items,`${n}.${o}`))}return a}function Tt(t){return`1 0 calc(${Math.floor(t/12*100)}% - 8px)`}function Nn(t,r){if(typeof r>"u"||!t)return t;if(r===!1)return;if(r===!0)return t;if(typeof t!="object")return r?t:void 0;const n=Object.assign({},t);for(const[i,s]of Object.entries(r))n[i]=Nn(n[i],s);return n}function ft(t,r){return t.reduce((n,i)=>[...n,...Array.isArray(i)?i:[i]],[]).filter(n=>n!==void 0).map(r)}function Ln(t){return ft(t,r=>!!r)}function H(t){return ft(t,r=>`${r}`)}function kn(t){return ft(t,r=>parseInt(r))}function Ft(t,r){if(t.length===0)return r;let n=t.find(i=>Array.isArray(i)?i.length>0:i!=null);return Array.isArray(n)&&(n=n[0]),n??r}function Wn(...t){if(t.length!==1)return 0;let r=t[0];if(Array.isArray(r)){if(r.length!==1)return 0;r=r[0]}return isNaN(parseInt(r))?0:parseInt(r)}function Vn(...t){if(t.length!==1)return!1;let r=t[0];if(Array.isArray(r)){if(r.length!==1)return!1;r=r[0]}return!!r}function Bn(...t){return H(t).map(r=>({displayValue:r,id:`#aggregate_${r}`}))}function Gn(...t){var r;const n=(r=H(t))===null||r===void 0?void 0:r[0];if(n)return{id:n}}function Hn(...t){return H(t).map(r=>({id:r}))}function ke(...t){return t.reduce((r,n)=>typeof n=="number"||typeof n=="string"&&!isNaN(n)?r+n:Array.isArray(n)?r+ke(...n):r,0)}function Un(t,r,...n){return Math.min(r,Math.max(t,Ft(n,t)))}function Kn(...t){return Math.floor(Ft(t,NaN))}function Dt(t,...r){const n=r.reduce((i,s)=>Array.isArray(s)?`${i}${t}${Dt(t,...s)}`:typeof s=="object"?i:`${i}${t}${s}`,"");return n.length===0?n:n.substring(t.length)}function zn(t,...r){const n=H(r);return Dt(t,n).split(t)}function Jn(...t){return H(t).map(r=>r.trim())}const Qn=Object.freeze(Object.defineProperty({__proto__:null,BETWEEN_RANGE:Un,FLOOR:Kn,JOIN:Dt,SPLIT:zn,SUM:ke,TO_BOOLEAN:Vn,TO_ENTITIES_FROM_IDS:Hn,TO_ENTITY_FROM_ID:Gn,TO_NUMBER:Wn,TO_OPTIONS_FROM_STRINGS:Bn,TRIM_ALL:Jn,asSingleValue:Ft,mapQueryResults:ft,toBooleans:Ln,toNumbers:kn,toStrings:H},Symbol.toStringTag,{value:"Module"}));function Yn(t){t=`with (sandbox) {${t}}`;const r=new Function("sandbox",t);return function(n){const i=new Proxy(n,{has:Xn,get:Zn});return r(i)}}function Xn(){return!0}function Zn(t,r){if(r!==Symbol.unscopables)return t[r]}function qn(t,r){const n=`return (${t.replace(/<base>/gi,"base")});`;try{return Yn(n)(Object.assign(Object.assign({},Qn),{base:r}))}catch{return}}function We(t,r,n,i){if(t.includes("return"))throw new Error("Filter expression must not contain return statement");let s=De(r,t,{serializeObjectsInSubQuery:a=>JSON.stringify(a),customDataAccessor:i});return s&&(s=J(s)),qn(s??t,n)}function ti(t,r){if(typeof t!="object"||t.type!=="object"||!t.properties)return t==null?void 0:t.$aggregate;let n=r??{};return n=Ve(t,X(n)),n}function Ve(t,r){if(typeof t=="object"){if(t.$aggregate)return t.$aggregate;if(t.type==="object"&&t.properties)for(const[n,i]of Object.entries(t.properties)){const s=r[n];if(typeof s=="string"){console.warn("Would overwrite aggregation, skipping");continue}let a=s??{};a=Ve(i,a),a&&(r[n]=a)}if(t.type==="object")return r}}function ei(t){return t?Be(t,"$"):[]}function Be(t,r){if(!t)return[];const n=[];for(const[i,s]of Object.entries(t)){const a=`${r}.${i}`;typeof s=="object"?n.push(...Be(s,a)):n.push({path:a,aggregation:s})}return n}function Ge(t,r){if(!r)return t;for(const n of Object.keys(r)){const i=r[n];typeof i=="object"?(typeof t[n]!="object"&&(t[n]={}),Ge(t[n],i)):typeof t[n]>"u"&&(t[n]=void 0)}}function ri(t,r,n){if(!r)return t;const i=ei(r),s=new Set(i.map(l=>l.path));let a=r;if(!a)return t;const o=X(t??{});Ge(o,a);const c=X(o);return He(o,a,c,s,i)}function He(t,r,n,i,s){if(!r)return t;for(const a of Object.keys(r)){const o=r[a];if(typeof o=="object"){typeof t[a]!="object"&&(t[a]={}),t[a]=He(t[a],o,n,i,s);continue}const c=Ue(n,i,s,[]);t[a]=We(o,n,t[a],c)}return t}function Ue(t,r,n,i){return(a,o)=>{var c;if(r.has(a)){if(i.includes(a))throw new Error(`circular reference detected when trying to resolve ${a}`);const{aggregation:l}=(c=n.find(d=>d.path===a))!==null&&c!==void 0?c:{};if(!l)return o;const p=Ue(t,r,n,[...i,a]);return We(l,t,o,p)}return o}}function ni(t,r){return r?ti(r,t):t}function Ti({schema:t,data:r,currentUserRole:n,aggregates:i,fieldSettings:s={},providedUiLayout:a,entityApi:o}){const c=_.useMemo(()=>Ne(t)?Dn(t,r):t,[t,r]),l=Ee(c),{hydratedData:p}=In(o,r,l),d=_.useMemo(()=>ni(i,l),[i,l]),y=_.useMemo(()=>ri(p,d),[p,d]),g=_.useMemo(()=>a?Q(a,l,s,n):Ce(l),[n,s,a,l]);return{aggregatedData:y,uiLayout:g,resolvedSchema:l,fullAggregates:d}}var jt,we;function ii(){if(we)return jt;we=1;function t(o,c){for(;o.length<c;)o="0"+o;return o}function r(o,c){var l,p,d;if(c.length===0)return o;for(l=0,d=c.length;l<d;l++)p=c.charCodeAt(l),o=(o<<5)-o+p,o|=0;return o<0?o*-2:o}function n(o,c,l){return Object.keys(c).sort().reduce(p,o);function p(d,y){return i(d,c[y],y,l)}}function i(o,c,l,p){var d=r(r(r(o,l),s(c)),typeof c);if(c===null)return r(d,"null");if(c===void 0)return r(d,"undefined");if(typeof c=="object"||typeof c=="function"){if(p.indexOf(c)!==-1)return r(d,"[Circular]"+l);p.push(c);var y=n(d,c,p);if(!("valueOf"in c)||typeof c.valueOf!="function")return y;try{return r(y,String(c.valueOf()))}catch(g){return r(y,"[valueOf exception]"+(g.stack||g.message))}}return r(d,c.toString())}function s(o){return Object.prototype.toString.call(o)}function a(o){return t(i(0,o,"",[]).toString(16),8)}return jt=a,jt}var oi=ii();const ut=Rt(oi),si=({schema:t,widgetLookup:r,path:n,aggregation:i,entityApi:s,currentUserRole:a,shouldShowFieldSettingControls:o,FormWidgetRenderer:c})=>{var l;const p=_.useMemo(()=>Te(i,t),[i,t]);let d=()=>null;return t.$uiWidget&&r[t.$uiWidget]?d=r[t.$uiWidget]:t.type==="integer"?d=r.number:typeof t.type=="string"&&(d=r[t.type]),d?t.title?S.jsx(c,{path:n,Widget:d,label:(l=t.title)!==null&&l!==void 0?l:"",aggregation:i,schema:t,entityApi:s,currentUserRole:a,shouldShowFieldSettingControls:o,aggregationSupport:p}):(console.error(`Schema definition at ${n} does not have title`,t),null):(console.error(`Could not find widget for schema definition at ${n}`,t),null)},ui=N.div`
	min-width: ${({minWidth:t})=>t}px;
`,ci=N.div`
	margin-bottom: 4px;
	flex: ${({cols:t})=>Tt(t)};
	min-width: 100px;
`,ai=N.div`
	margin-bottom: ${({marginBottom:t})=>t??0}px;
	flex: ${({cols:t})=>Tt(t)};
	min-width: 100%;
`,ct=N.div`
	display: flex;
	flex-wrap: wrap;
	width: 100%;
	column-gap: 8px;
`,fi=N.div`
	display: flex;
	min-width: 100px;
	flex-wrap: wrap;
	flex-direction: row;
	width: 100%;
	column-gap: 8px;
`,li=N.div`
	display: flex;
	flex-wrap: wrap;
	width: 100%;
	column-gap: 8px;
	flex: ${({cols:t})=>Tt(t)};
	align-content: flex-start;
`,di=({uiLayout:t,schema:r,widgetLookup:n,UiSection:i,aggregates:s,entityApi:a,currentUserRole:o,shouldShowFieldSettingControls:c,FormWidgetRenderer:l})=>{var p;const d=[];function y(g){return S.jsx(pi,{uiLayout:g,schema:r,widgetLookup:n,UiSection:i,aggregates:s,entityApi:a,currentUserRole:o,shouldShowFieldSettingControls:c,FormWidgetRenderer:l})}for(const g of t)if(typeof g=="string"){const b=at({location:g,schema:r});if(!b||b.type==="object"&&!b.properties)continue;const j=D({location:g,root:s??{}});if(b.type==="object"&&!b.$uiWidget){const E=Ce(b,g);d.push(S.jsx(ct,{children:y(E)},G(g)))}else{const E=(p=b.$uiCols)!==null&&p!==void 0?p:_e(t,r,g);d.push(S.jsx(ci,{cols:E,children:S.jsx(ui,{minWidth:100,children:S.jsx(si,{schema:b,widgetLookup:n,path:g,aggregation:j,entityApi:a,currentUserRole:o,shouldShowFieldSettingControls:c,FormWidgetRenderer:l})})},G(g)))}}else if(Y(g)&&g.kind==="section"){const b=y(g.uiLayout);i?d.push(S.jsx(ct,{children:S.jsx(i,{title:g.title,children:b})},G(g))):d.push(S.jsx(ct,{children:b},G(g)))}else if(Y(g)&&g.kind==="columnLayout"){const b=g.columns.map(j=>j.cols||"auto");d.push(S.jsx(fi,{children:g.columns.map((j,E)=>S.jsx(li,{cols:j.cols||Le(b),children:y(j.uiLayout)},E))},G(g)))}else Y(g)&&g.kind==="whiteSpace"?d.push(S.jsx(ai,{cols:_e(t,r,g),marginBottom:g.marginBottom},`white-space-${d.length}`)):d.push(S.jsx(ct,{children:y(g)},G(g)));return S.jsx(S.Fragment,{children:d})},pi=$e.memo(di);function G(t){return typeof t=="string"?t:Y(t)?t.kind==="columnLayout"?`column-layout-${ut(t)}`:t.kind==="section"?`section-layout-${t.title}-${ut(t)}`:`element-${ut(t)}`:`ui-layout-${ut(t)}`}const Fi=N.div`
	display: flex;
	flex-direction: column;
`;var St,xe;function Ke(){return xe||(xe=1,St=function(r,n){var i="000000000"+r;return i.substr(i.length-n)}),St}var At,je;function hi(){if(je)return At;je=1;var t=Ke(),r=typeof window=="object"?window:self,n=Object.keys(r).length,i=navigator.mimeTypes?navigator.mimeTypes.length:0,s=t((i+navigator.userAgent.length).toString(36)+n.toString(36),4);return At=function(){return s},At}var $t,Se;function yi(){if(Se)return $t;Se=1;var t,r=typeof window<"u"&&(window.crypto||window.msCrypto)||typeof self<"u"&&self.crypto;if(r){var n=Math.pow(2,32)-1;t=function(){return Math.abs(r.getRandomValues(new Uint32Array(1))[0]/n)}}else t=Math.random;return $t=t,$t}var Ot,Ae;function gi(){if(Ae)return Ot;Ae=1;var t=hi(),r=Ke(),n=yi(),i=0,s=4,a=36,o=Math.pow(a,s);function c(){return r((n()*o<<0).toString(a),s)}function l(){return i=i<o?i:0,i++,i-1}function p(){var d="c",y=new Date().getTime().toString(a),g=r(l().toString(a),s),b=t(),j=c()+c();return d+y+g+b+j}return p.slug=function(){var y=new Date().getTime().toString(36),g=l().toString(36).slice(-4),b=t().slice(0,1)+t().slice(-1),j=c().slice(-2);return y.slice(-2)+g+b+j},p.isCuid=function(y){return typeof y!="string"?!1:!!y.startsWith("c")},p.isSlug=function(y){if(typeof y!="string")return!1;var g=y.length;return g>=7&&g<=10},p.fingerprint=t,Ot=p,Ot}var bi=gi();const vi=Rt(bi),_i={Date:!0,RegExp:!0,String:!0,Number:!0};function ze(t,r,n={cyclesFix:!0},i=[]){let s=[];const a=Array.isArray(t);for(const c in t){const l=t[c],p=a?+c:c;if(!(c in r)){s.push({type:"REMOVE",path:[p],oldValue:t[c]});continue}const d=r[c],y=typeof l=="object"&&typeof d=="object";if(l&&d&&y&&!_i[Object.getPrototypeOf(l).constructor.name]&&(!n.cyclesFix||!i.includes(l))){const g=ze(l,d,n,n.cyclesFix?i.concat([l]):[]);s.push.apply(s,g.map(b=>(b.path.unshift(p),b)))}else l!==d&&!(y&&(isNaN(l)?l+""==d+"":+l==+d))&&s.push({path:[p],type:"CHANGE",value:d,oldValue:l})}const o=Array.isArray(r);for(const c in r)c in t||s.push({type:"CREATE",path:[o?+c:c],value:r[c]});return s}function mi(t){const r=_.useRef(t),n=_.useRef({}),i=_.useCallback((a,o)=>{const c=vi();return xi(n.current,{path:a,onUpdate:o,id:c}),()=>{wi(n.current,a,c)}},[]),s=_.useCallback(a=>D({location:a,root:r.current}),[]);return _.useEffect(()=>{if(t===r.current)return;const a=ze(r.current,t,{cyclesFix:!1});if(r.current=t,a.length===0)return;const o={};for(const c of a){const l=`$.${c.path.join(".")}`,p=ji(n.current,l);for(const d of p)o[d.id]=d}for(const c of Object.values(o))c.onUpdate(s(c.path))},[t,s]),{subscribe:i,getDataAtPath:s}}function wi(t,r,n){const i=D({root:t,accessNext:(a,o)=>{if(typeof o!="symbol")return a.children||(a.children={}),a.children[o]||(a.children[o]={}),a.children[o]},location:r});if(!(i!=null&&i.subscriptions))return;const s=i.subscriptions.findIndex(a=>a.id===n);s!==-1&&i.subscriptions.splice(s,1)}function xi(t,r){const n=D({root:t,accessNext:(i,s)=>{if(typeof s!="symbol")return i.children||(i.children={}),i.children[s]||(i.children[s]={}),i.children[s]},location:r.path});n.subscriptions||(n.subscriptions=[]),n.subscriptions.push(r)}function ji(t,r){var n;const i=Ct(r),s=[];let a=t;for(let o=0;o<i.length;o++){const c=i[o];if(typeof c=="symbol")throw new Error("Symbol indexer not allowed here");if(!(c==="$"&&o===0)){if(a.subscriptions&&s.push(...a.subscriptions),!(!((n=a.children)===null||n===void 0)&&n[c]))return s;a=a.children[c]}}return[...s,...Je(a)]}function Je(t){var r;if(!t.children)return(r=t.subscriptions)!==null&&r!==void 0?r:[];const n=[];for(const i of Object.values(t.children))n.push(...Je(i));return n}function Di(t){const r=$e.createContext({subscribe:()=>()=>{},getDataAtPath:i=>D({root:t,location:i})});return{Provider:({value:i,children:s})=>{const{subscribe:a,getDataAtPath:o}=mi(i),c=_.useMemo(()=>({subscribe:a,getDataAtPath:o}),[o,a]);return S.jsx(r.Provider,{value:c,children:s})},ReactContext:r}}function Ii(t,r="$"){const{ReactContext:n}=t,i=Ee(Ct(r)),{subscribe:s,getDataAtPath:a}=_.useContext(n),[o,c]=_.useState(()=>a(r));return _.useEffect(()=>{c(a(i));const l=s(i,p=>{c(p)});return()=>l()},[a,i,s]),o}export{Fi as F,X as a,Ti as b,Di as c,pi as d,Ee as e,Nn as r,Ri as s,Ii as u};
